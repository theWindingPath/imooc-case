<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>简易计算器-js</title>
    <style>
        body {
            background-color: #eee;
        }
        #calculator {
            margin: 100px 0 0 150px;
        }
    </style>
</head>

<body>

    <!-- 简易计算器 -->
    <div id="calculator">
        <p>
            <input type="text" class="formerInput" value="1" />
            <span class="sign">+</span>
            <input type="text" class="laterInput" value="1" />
            <span>=</span>
            <span class="resultOutput">2</span>
        </p>
        <p>
            <!-- <input type="button" value="+" onclick="addHandler();" />
            <input type="button" value="-" onclick="subtractHandler();" />
            <input type="button" value="×" onclick="multiplyHandler();" />
            <input type="button" value="÷" onclick="divideHandler();" /> -->

            <input type="button" value="+" class="btn" title="add" />
            <input type="button" value="-" class="btn" title="subtract" />
            <input type="button" value="×" class="btn" title="multiply" />
            <input type="button" value="÷" class="btn" title="divide" />
            <!-- 增加新功能 -->
            <input type="button" value="%" class="btn" title="mod" />
            <input type="button" value="^" class="btn" title="power" />
            <input type="button" value="1/x" class="btn" title="invert" />
        </p>
    </div>


    <script>
        // // 最容易做到的
        // // 获取元素 所有 DOM元素
        // var calculator = document.querySelector('#calculator');
        // var formerInput = calculator.querySelector('.formerInput');
        // var laterInput = calculator.querySelector('.laterInput');
        // var sign = calculator.querySelector('.sign');
        // var resultOutput = calculator.querySelector('.resultOutput');

        // // 加
        // function addHandler() {
        //     sign.innerHTML = '+'; // 修改符号
        //     resultOutput.innerHTML = +formerInput.value + +laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 减
        // function subtractHandler() {
        //     sign.innerHTML = '-'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value - laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 乘
        // function multiplyHandler() {
        //     sign.innerHTML = '×'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value * laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 除
        // function divideHandler() {
        //     sign.innerHTML = '÷'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value / laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }

        // // 第一次改进--将结构和行为分离
        // // 获取元素 所有 DOM元素
        // var calculator = document.querySelector('#calculator');
        // var formerInput = calculator.querySelector('.formerInput');
        // var laterInput = calculator.querySelector('.laterInput');
        // var sign = calculator.querySelector('.sign');
        // var resultOutput = calculator.querySelector('.resultOutput');
        // var btns = calculator.querySelectorAll('.btn');

        // // 绑定事件
        // //+
        // btns[0].onclick = addHandler; //没有 （）的是函数本体
        // // btns[0].onclick = addHandler(); // 有（）会自动执行
        // //-
        // btns[1].onclick = subtractHandler;
        // //×
        // btns[2].onclick = multiplyHandler;
        // //÷
        // btns[3].onclick = divideHandler;


        // // 加
        // function addHandler() {
        //     sign.innerHTML = '+'; // 修改符号
        //     resultOutput.innerHTML = +formerInput.value + +laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 减
        // function subtractHandler() {
        //     sign.innerHTML = '-'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value - laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 乘
        // function multiplyHandler() {
        //     sign.innerHTML = '×'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value * laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 除
        // function divideHandler() {
        //     sign.innerHTML = '÷'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value / laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }

        // // 第二次改进--使用循环
        // // 获取元素 所有 DOM元素
        // var calculator = document.querySelector('#calculator');
        // var formerInput = calculator.querySelector('.formerInput');
        // var laterInput = calculator.querySelector('.laterInput');
        // var sign = calculator.querySelector('.sign');
        // var resultOutput = calculator.querySelector('.resultOutput');
        // var btns = calculator.querySelectorAll('.btn');

        // // 绑定事件
        // for (var i = 0; i < btns.length; i++) {
        //     btns[i].onclick = function () { // 写一个匿名函数 在匿名函数里判断
        //         // console.log(this.value);
        //         switch (this.title) {
        //             case 'add':
        //                 addHandler();
        //                 break;
        //             case 'subtract':
        //                 subtractHandler();
        //                 break;
        //             case 'multiply':
        //                 multiplyHandler();
        //                 break;
        //             case 'divide':
        //                 divideHandler();
        //                 break;
        //         }
        //     };
        // }
        // // //+
        // // btns[0].onclick = addHandler; //没有 （）的是函数本体
        // // // btns[0].onclick = addHandler(); // 有（）会自动执行
        // // //-
        // // btns[1].onclick = subtractHandler;
        // // //×
        // // btns[2].onclick = multiplyHandler;
        // // //÷
        // // btns[3].onclick = divideHandler;


        // // 加
        // function addHandler() {
        //     sign.innerHTML = '+'; // 修改符号
        //     resultOutput.innerHTML = +formerInput.value + +laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 减
        // function subtractHandler() {
        //     sign.innerHTML = '-'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value - laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 乘
        // function multiplyHandler() {
        //     sign.innerHTML = '×'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value * laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }
        // // 除
        // function divideHandler() {
        //     sign.innerHTML = '÷'; // 修改符号
        //     resultOutput.innerHTML = formerInput.value / laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        // }

        // // 第三次改进--提取函数
        // // 获取元素 所有 DOM元素
        // var calculator = document.querySelector('#calculator');
        // var formerInput = calculator.querySelector('.formerInput');
        // var laterInput = calculator.querySelector('.laterInput');
        // var sign = calculator.querySelector('.sign');
        // var resultOutput = calculator.querySelector('.resultOutput');
        // var btns = calculator.querySelectorAll('.btn');

        // // 绑定事件 each函数执行
        // each003(btns, function (index, elem) {
        //     elem.onclick = function () { // 写一个匿名函数 在匿名函数里判断
        //         // console.log(this.value);
        //         switch (this.title) {
        //             case 'add':
        //                 addHandler();
        //                 break;
        //             case 'subtract':
        //                 subtractHandler();
        //                 break;
        //             case 'multiply':
        //                 multiplyHandler();
        //                 break;
        //             case 'divide':
        //                 divideHandler();
        //                 break;
        //         }
        //     };
        // });

        // // 遍历 array 对应上面 each 里 的 btns  each函数定义
        // function each003(array, fn003) { // fn003 对应上面 each 里的 function(index, elem) 匿名函数
        //     for (var i = 0; i < array.length; i++) {  // 每个 btns 都要绑定 onclick事件
        //         // array[i] 对应上面 each 里的匿名函数 里的 elem
        //         fn003(i, array[i]); // 回调函数 调上面的 each 里的 function(index, elem) 匿名函数
        //     }
        // }

        // // 更新符号
        // function updateSign(symbol) {
        //     sign.innerHTML = symbol;
        // }

        // // 加法
        // function add(num1, num2) {
        //     return +num1 + +num2;
        // }
        // // 减法
        // function subtract(num1, num2) {
        //     return num1 - num2;
        // }
        // // 乘法
        // function multiply(num1, num2) {
        //     return num1 * num2;
        // }
        // // 除法
        // function divide(num1, num2) {
        //     return num1 / num2;
        // }

        // // 输出结果
        // function outputResult(result) {
        //     resultOutput.innerHTML = result;
        // }


        // // 加
        // function addHandler() {
        //     // sign.innerHTML = '+'; // 修改符号
        //     updateSign('+');
        //     // resultOutput.innerHTML = +formerInput.value + +laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        //     // resultOutput.innerHTML = add(formerInput.value , laterInput.value);
        //     outputResult(add(formerInput.value , laterInput.value));
        // }
        // // 减
        // function subtractHandler() {
        //     updateSign('-');
        //     outputResult(subtract(formerInput.value , laterInput.value));
        // }
        // // 乘
        // function multiplyHandler() {
        //     updateSign('×');
        //     outputResult(multiply(formerInput.value , laterInput.value));
        // }
        // // 除
        // function divideHandler() {
        //     updateSign('÷');
        //     outputResult(divide(formerInput.value , laterInput.value));
        // }

        // // 第四次改进--管理代码（找到组织）
        // // 获取元素 所有 DOM元素
        // var wrapElem = document.querySelector('#calculator');
        // var calculatorElem = { // 创建一个对象 管理变量
        //     formerInput: wrapElem.querySelector('.formerInput'),
        //     laterInput: wrapElem.querySelector('.laterInput'),
        //     sign: wrapElem.querySelector('.sign'),
        //     resultOutput: wrapElem.querySelector('.resultOutput'),
        //     btns: wrapElem.querySelectorAll('.btn')
        // };
        // // console.log(calculatorElem);

        // // 绑定事件
        // each(calculatorElem.btns, function (index, elem) {
        //     elem.onclick = function () { // 写一个匿名函数 在匿名函数里判断
        //         // console.log(this.value);
        //         switch (this.title) {
        //             case 'add':
        //                 addHandler();
        //                 break;
        //             case 'subtract':
        //                 subtractHandler();
        //                 break;
        //             case 'multiply':
        //                 multiplyHandler();
        //                 break;
        //             case 'divide':
        //                 divideHandler();
        //                 break;
        //         }
        //     };
        // });

        // // 遍历
        // function each(array, fn) {
        //     for (var i = 0; i < array.length; i++) {
        //         fn(i, array[i]); // 回调函数 调上面的 each
        //     }
        // }

        // // 更新符号
        // function updateSign(symbol) {
        //     calculatorElem.sign.innerHTML = symbol;
        // }

        // var operation = { // 创建对象管理函数 方法
        //      add:function(num1, num2) {
        //         return +num1 + +num2;
        //     },
        //      subtract:function(num1, num2) {
        //         return num1 - num2;
        //     },
        //      multiply:function(num1, num2) {
        //         return num1 * num2;
        //     },
        //      divide:function(num1, num2) {
        //         return num1 / num2;
        //     }
        // };


        // // 输出结果
        // function outputResult(result) {
        //     calculatorElem.resultOutput.innerHTML = result;
        // }


        // // 加
        // function addHandler() {
        //     // sign.innerHTML = '+'; // 修改符号
        //     updateSign('+');
        //     // resultOutput.innerHTML = +formerInput.value + +laterInput.value; // 前面需要加 + 从 DOM获取来的都是字符串
        //     // resultOutput.innerHTML = add(formerInput.value , laterInput.value);
        //     outputResult(operation.add(calculatorElem.formerInput.value, calculatorElem.laterInput.value));
        // }
        // // 减
        // function subtractHandler() {
        //     updateSign('-');
        //     outputResult(operation.subtract(calculatorElem.formerInput.value, calculatorElem.laterInput.value));
        // }
        // // 乘
        // function multiplyHandler() {
        //     updateSign('×');
        //     outputResult(operation.multiply(calculatorElem.formerInput.value, calculatorElem.laterInput.value));
        // }
        // // 除
        // function divideHandler() {
        //     updateSign('÷');
        //     outputResult(operation.divide(calculatorElem.formerInput.value, calculatorElem.laterInput.value));
        // }

        // 第五次改进--OCP 开放--封闭原则
        // 获取元素 所有 DOM元素
        var wrapElem = document.querySelector('#calculator');
        var calculatorElem = { // 创建一个对象 管理变量
            formerInput: wrapElem.querySelector('.formerInput'),
            laterInput: wrapElem.querySelector('.laterInput'),
            sign: wrapElem.querySelector('.sign'),
            resultOutput: wrapElem.querySelector('.resultOutput'),
            btns: wrapElem.querySelectorAll('.btn')
        };
        // console.log(calculatorElem);

        // 绑定事件
        each(calculatorElem.btns, function (index, elem) {
            elem.onclick = function () { // 写一个匿名函数 在匿名函数里判断
                // console.log(this.value);
                updateSign(this.value); // 将符号 + - × ÷ 通过 value 传进来
                //调用 operate方法 代替 switch
                outputResult(operate(this.title, calculatorElem.formerInput.value, calculatorElem.laterInput.value));
            }
        });

        // 遍历
        function each(array, fn) {
            for (var i = 0; i < array.length; i++) {
                fn(i, array[i]); // 回调函数 调上面的 each
            }
        }

        // 运算函数 代替switch
        function operate(name, num1, num2) {
            //手动抛出错误 判断传入 name 是否存在 为真？
            if (!operation[name]) throw new Error('不存在名为' + name + '的运算方法');
            // 调用 穿起来 name对应 operation 方法 变量通过中括号调用 没法用 . 调用
            return operation[name](num1, num2);
        }

        // 更新符号
        function updateSign(symbol) {
            calculatorElem.sign.innerHTML = symbol;
        }

        var operation = { // 创建对象管理函数 方法
            add: function (num1, num2) {
                return +num1 + +num2;
            },
            subtract: function (num1, num2) {
                return num1 - num2;
            },
            multiply: function (num1, num2) {
                return num1 * num2;
            },
            divide: function (num1, num2) {
                return num1 / num2;
            },
            // // 增加新功能 mod
            // mod: function (num1, num2) {
            //     return num1 % num2;
            // },
            // 提供方法 给外部添加新方法
            addOperation:function(name, fn) {
                // 判断传进来方法是否已存在
                if(!this[name]) {
                    this[name] = fn;
                }
                return this; // 链式调用
            }
        };

        // 在外部添加新方法
        operation.addOperation('mod', function(num1, num2){
            return num1 % num2;
        }).addOperation('power',function(base, power){ //链式操作
          return Math.pow(base, power);  //调用幂函数 底数 n次幂
        });

        // 输出结果
        function outputResult(result) {
            calculatorElem.resultOutput.innerHTML = result;
        }

        // // 第六次改进--模块化
        // (function () { //匿名函数 ()()在定义同时执行 内部代码变成局部变量 
        //     // 获取元素 所有 DOM元素
        //     var wrapElem = document.querySelector('#calculator');
        //     var calculatorElem = { // 创建一个对象 管理变量
        //         formerInput: wrapElem.querySelector('.formerInput'),
        //         laterInput: wrapElem.querySelector('.laterInput'),
        //         sign: wrapElem.querySelector('.sign'),
        //         resultOutput: wrapElem.querySelector('.resultOutput'),
        //         btns: wrapElem.querySelectorAll('.btn')
        //     };
        //     // console.log(calculatorElem);

        //     // 绑定事件
        //     each(calculatorElem.btns, function (index, elem) {
        //         elem.onclick = function () { // 写一个匿名函数 在匿名函数里判断
        //             // console.log(this.value);
        //             updateSign(this.value); // 将符号 + - × ÷ 通过 value 传进来
        //             //调用 operate方法 代替 switch
        //             outputResult(operate(this.title, calculatorElem.formerInput.value, calculatorElem.laterInput
        //                 .value));
        //         }
        //     });

        //     // 遍历 绑定事件 循环
        //     function each(array, fn) {
        //         for (var i = 0; i < array.length; i++) {
        //             fn(i, array[i]); // 回调函数 调上面的 each
        //         }
        //     }

        //     // 运算 封装成 匿名函数 自执行
        //     var operate = (function () {  //定义变量 接收返回值 暴露出的接口

        //         var operation = { // 创建对象管理函数 方法
        //             add: function (num1, num2) {
        //                 return +num1 + +num2;
        //             },
        //             subtract: function (num1, num2) {
        //                 return num1 - num2;
        //             },
        //             multiply: function (num1, num2) {
        //                 return num1 * num2;
        //             },
        //             divide: function (num1, num2) {
        //                 return num1 / num2;
        //             },
        //             // // 增加新功能 mod
        //             // mod: function (num1, num2) {
        //             //     return num1 % num2;
        //             // },
        //             // 提供方法 给外部添加新方法
        //             addOperation: function (name, fn) {
        //                 // 判断传进来方法是否已存在
        //                 if (!operation[name]) { //将this 改为指向 operation 下方法 2、谁调用 this 会指向谁
        //                     operation[name] = fn;
        //                 }
        //                 return operation; // 链式调用
        //             }
        //         };

        //         // function operate(name, num1, num2) {
        //         //     //手动抛出错误 判断传入 name 是否存在 为真？
        //         //     if (!operation[name]) throw new Error('不存在名为' + name + '的运算方法');
        //         //     // 调用 穿起来 name对应 operation 方法 变量通过中括号调用 没法用 . 调用
        //         //     return operation[name](num1, num2);
        //         // }
        //         function operate(name) {
        //             //手动抛出错误 判断传入 name 是否存在 为真？
        //             if (!operation[name]) throw new Error('不存在名为' + name + '的运算方法');
        //             // 调用 穿起来 name对应 operation 方法 变量通过中括号调用 没法用 . 调用
        //             // console.log([].slice.call(arguments, 1, arguments.length)); // slice 截断类数组第一个值 call 第一个参数传入arguments 类数组 从1 截到.lenght 0截走
        //             // console.log(arguments);
        //             return operation[name].apply(operation, [].slice.call(arguments, 1, arguments.length)); //agrs第一个元素是 name 
        //         }
        //         operate.addOperation = operation.addOperation; //operate调用 addO函数 相当于 operation 调用

        //         return operate; // 将 operate返回

        //         // return function (name, num1, num2) {  // 将匿名函数 返回
        //         //     //手动抛出错误 判断传入 name 是否存在 为真？
        //         //     if (!operation[name]) throw new Error('不存在名为' + name + '的运算方法');
        //         //     // 调用 穿起来 name对应 operation 方法 变量通过中括号调用 没法用 . 调用
        //         //     return operation[name](num1, num2);
        //         // }; 

        //     })();

        //     // 更新符号
        //     function updateSign(symbol) {
        //         calculatorElem.sign.innerHTML = symbol;
        //     }

        //     // 在外部添加新方法
        //     operate.addOperation('mod', function (num1, num2) { //相当于 operation 调用
        //         return num1 % num2;
        //     }).addOperation('power', function (base, power) { //链式操作
        //         return Math.pow(base, power); //调用幂函数 底数 n次幂
        //     }).addOperation('invert',function(num){ // 参数只有一个值  //加个求倒数方法 2 的倒数 1/2 
        //       return 1/num;
        //     });

        //     // 输出结果
        //     function outputResult(result) {
        //         calculatorElem.resultOutput.innerHTML = result;
        //     }

        // })()

        // // call(); //执行函数 命名函数 先定义 后执行
    </script>

</body>

</html>